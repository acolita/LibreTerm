# wstc v0.2.0 Plan (Data & Configuration)

**Goal:** Transform `wstc` from a hardcoded prototype into a usable tool by adding persistence and configuration UI.

## 1. Core Philosophy
*   **Native & Lightweight:** Continue using pure Win32 API.
*   **Zero Dependencies:** Use Windows built-in `.ini` file support (`GetPrivateProfileString`, `WritePrivateProfileString`) instead of heavy JSON libraries.

## 2. Features

### A. Persistence (The Data Layer)
*   **Format:** `connections.ini` in `%APPDATA%\wstc\` (or local folder for portability).
*   **Structure:**
    ```ini
    [Sessions]
    Count=2
    
    [Session_1]
    Name=Web Server 01
    Host=192.168.1.10
    Port=22
    User=admin
    
    [Session_2]
    Name=Dev Box
    Host=localhost
    Port=2222
    ```
*   **Loading:** On startup, read INI and populate the `TreeView`.
*   **Saving:** When a connection is added/edited, write to INI.

### B. Connection Management (The UI)
*   **Resource Script (`.rc`):** Define a native Dialog Box template for "Connection Details".
    *   Fields: *Name*, *Hostname/IP*, *Port*, *Username*, *Extra Args*.
*   **Context Menus:**
    *   **TreeView:** Right-click -> *Connect*, *Edit*, *Delete*, *New Connection*.
    *   **TabControl:** Right-click -> *Close*, *Close Others*.

### C. PuTTY Integration (The Logic)
*   **Argument Generation:** Construct the command line dynamically based on the connection details.
    *   `putty.exe -ssh <user>@<host> -P <port>`
*   **Path Configuration:** A simple "Settings" dialog to configure the path to `putty.exe` (saved in `settings.ini`).

### D. Refinement
*   **Icons:** Add basic ImageList to TreeView (Folder vs Server icon).
*   **Focus Fixes:** Implement `WM_SETFOCUS` handling to ensure the embedded window gets focus immediately after tab switch.

## 3. Technical Implementation Steps
1.  **Resources:** Create `wstc.rc` and `resource.h` to define the Dialog Box and Menus.
2.  **Data Model:** Create `ConnectionManager` class to wrap the INI reading/writing.
3.  **Dialog Proc:** Implement the `DialogProc` callback to handle user input in the "New Connection" form.
4.  **Wiring:** Connect the Dialog results to the `TreeView` and `ConnectionManager`.
5.  **Execution:** Update `LaunchSession` to take a `Connection` struct instead of just a name.
