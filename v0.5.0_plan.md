# wstc v0.5.0 Plan (Password Support)

**Goal:** Enable storing passwords (in plain text) and passing them automatically to PuTTY and WinSCP to streamline the login process.

## 1. Data Model
*   **Struct:** Add `std::wstring password` to the `Connection` struct.
*   **Persistence:** Load and save the `Password` key in `connections.ini`.

## 2. UI Updates
*   **Connection Dialog:**
    *   Add a new **Password** text field.
    *   Use the `ES_PASSWORD` style to mask the input (display dots instead of characters).
    *   Position it typically below the Username field.

## 3. Tool Integration

### A. PuTTY
*   **Mechanism:** Use the standard `-pw` command-line argument.
*   **Logic:**
    ```cpp
    std::wstring cmd = ...;
    if (!conn.password.empty()) {
        cmd += L" -pw \"" + conn.password + L"\"";
    }
    ```
*   **Constraint:** Ensure this is handled separately from the "Args" field so users don't have to manually type flags.

### B. WinSCP
*   **Mechanism:** Use the `/password` switch (preferred over URL embedding to avoid encoding complex characters).
*   **Logic:**
    ```cpp
    std::wstring cmd = ...;
    cmd += L" sftp://" + user + L"@" + host ...;
    if (!conn.password.empty()) {
        cmd += L" /password=\"" + conn.password + L"\"";
    }
    ```

## 4. Technical Implementation Steps
1.  **Resources:** Add `IDC_EDIT_PASSWORD` to `resource.h` and update `wstc.rc`.
2.  **Manager:** Update `LoadConnections` and `SaveConnections` in `ConnectionManager.cpp`.
3.  **Dialog:** Update `ConnectionDialogProc` in `MainWindow.cpp` to read/write the password field.
4.  **Launcher:** Update `LaunchSession` and `LaunchWinSCP` to inject the password into the command line strings.
